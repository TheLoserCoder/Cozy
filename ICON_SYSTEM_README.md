# Система управления иконками

## Обзор
Создана комплексная система управления иконками для FastLink и LinkItem компонентов с поддержкой различных типов иконок и автоматического скачивания favicon.

## Основные компоненты

### 1. Компонент Icon (`src/components/Icon.tsx`)
- Универсальный компонент для отображения иконок
- Поддерживает стандартные иконки Radix, пользовательские иконки, паки иконок и favicon
- Автоматический fallback на первую букву названия
- Поддержка SVG с применением цвета

### 2. Обновленный IconPicker (`src/components/IconPicker.tsx`)
- Вкладки: Стандартные, Пользовательские, Паки
- Добавление иконок по URL или загрузка файлов
- Интеграция с SettingsThemeProvider
- Поддержка выбора различных типов иконок

### 3. Worker (`src/worker.ts`)
- Функции для скачивания favicon
- Сохранение иконок в IndexedDB (blob для изображений, строка для SVG)
- Система экспорта/импорта данных IndexedDB
- Поддержка различных типов иконок

## Типы иконок

### IconType
- `standard` - стандартные иконки Radix
- `custom` - пользовательские иконки
- `pack` - иконки из паков
- `favicon` - автоматически скачанные favicon

## Обновленные типы данных

### FastLink
```typescript
interface FastLink {
  // ... существующие поля
  iconId?: string; // ID иконки в системе управления
  iconType?: 'standard' | 'custom' | 'pack' | 'favicon';
}
```

### LinkListItem
```typescript
interface LinkListItem {
  // ... существующие поля
  iconId?: string;
  iconType?: 'standard' | 'custom' | 'pack' | 'favicon';
}
```

## Настройки

### FastLinkSettings
- Добавлено поле `globalIconColor` для глобального цвета иконок
- Поддержка применения цвета к SVG иконкам

### Настройки в UI
- Секция управления иконками в настройках
- Поле для настройки глобального цвета иконок FastLink
- Базовая структура для управления паками иконок

## Автоматическое скачивание favicon

### При добавлении ссылки
- Автоматически скачивается favicon через worker
- Сохраняется в IndexedDB с уникальным ID
- Поддержка как изображений, так и SVG

### При редактировании URL
- Если URL изменился и нет пользовательской иконки, скачивается новый favicon
- Сохраняется обратная совместимость со старым полем iconUrl

## Экспорт/Импорт

### Расширенный формат данных
- Версия 2.0.0 с поддержкой IndexedDB
- Экспорт всех пользовательских иконок и паков
- При импорте данные записываются в IndexedDB с перезаписью при совпадении ID

## Интеграция с Redux

### Новые actions в fastLinksSlice
- `resetFastLinkIcon` - сброс иконки к favicon
- `resetAllFastLinkIcons` - сброс всех иконок
- Поддержка полей `iconId` и `iconType` в `editFastLink`

### Новые actions в themeSlice
- `setFastLinksGlobalIconColor` - установка глобального цвета иконок

## Диалоги редактирования

### EditFastLinkDialog
- Добавлен IconPicker для выбора иконки
- Автоматическое скачивание favicon при изменении URL
- Поддержка сброса иконки

## Компоненты отображения

### FastLink
- Использует новый компонент Icon
- Поддержка глобального цвета иконок
- Fallback на старое поле iconUrl для совместимости

### LinkItem
- Интеграция с компонентом Icon
- Поддержка всех типов иконок
- Fallback на первую букву названия

## Планы развития

### Паки иконок
- Полная реализация загрузки и управления паками
- UI для создания, редактирования и удаления паков
- Возможность переименования и добавления иконок в существующие паки

### Дополнительные функции
- Поиск по иконкам
- Категоризация пользовательских иконок
- Предпросмотр иконок в большем размере
- Массовые операции с иконками

## Совместимость
Система полностью обратно совместима с существующими данными. Старые ссылки продолжают работать через поле `iconUrl`, новые используют систему управления иконками.